import{c as pe,r as ce,E as me,d as _e,a as ge,b as fe,e as ve,u as be,p as ae}from"./base-DvbvbBHV.js";import{E as oe}from"./el-card-COD-MnUM.js";import{m as x,E as ne,a as he,b as Se,c as ye}from"./moment-DDfhJGG8.js";import{d as H,i as I,s as A,v as Ce,j as X,l,o as y,e as R,w as t,a as e,q as C,x as D,y as $,c as M,h as j,t as z,F as G,g as V,f as Z,z as Ee,A as we,B as ke,p as Pe,m as Ve,C as Te}from"./index-LKtde7Go.js";import{E as re,a as se}from"./el-form-item-C1MzpRF9.js";import{E as ee}from"./el-button-eM0nICzE.js";import{E as ie,a as de}from"./el-radio-group-Dx0gBDqt.js";import{E as te}from"./el-input-tt2YVnBp.js";import"./el-scrollbar-BicFTd-U.js";import"./el-popper-Bc4QHzYF.js";import{_ as xe}from"./RichTextEditor.vue_vue_type_script_setup_true_lang-CdWtr0qY.js";import{u as L}from"./ContestStore-y1JtAu0i.js";import{a as De,u as $e}from"./contest-BrCYgqo3.js";/* empty css                   */import{E as O}from"./index-NiwP3CxB.js";import{E as Ie}from"./el-pagination-BfkI3NRW.js";/* empty css               */import"./el-select-gyQoVtGG.js";import{E as Me,a as Ye}from"./el-table-column-DvdFlUM9.js";import"./el-tooltip-l0sNRNKZ.js";import{g as Ue}from"./Problem-B1GLUNaI.js";import{E as ze}from"./index-D5u-W1zK.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as Be}from"./el-message-box-QWHFX1tv.js";import"./el-overlay-CsqbOrQ3.js";import{E as qe}from"./el-link-CjOtOGtp.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./use-global-config-Bzh3Re1N.js";import"./index--WTq78Ch.js";import"./index-o4Mj7WB1.js";import"./isEqual-Bqj0i0KJ.js";import"./scroll-DFhJK82i.js";import"./use-form-item-A1Lv5lMY.js";import"./constants-BKNBpI0e.js";import"./event-BB_Ol6Sd.js";import"./vnode-JMlPDt7W.js";import"./castArray-C1_3P-VM.js";import"./_baseClone-BB7YdJx2.js";import"./_initCloneObject-CtYayvLz.js";import"./index-riLredlm.js";import"./focus-trap-TWyvYMmg.js";import"./httpAdmin-BbXC_-kD.js";import"./aria-nkjrUMQ-.js";import"./validator-BGTowSNF.js";const Re={style:{width:"100%",display:"flex","justify-content":"center"}},He=H({__name:"ContestSettingPage",props:{cid:{}},emits:["changeStep"],setup(w,{emit:h}){const k=w,n=I(),_=h,g=L(),{editContestParams:a,editResult:S}=A(g),p=I(),i=I(),c=()=>{a.value.registerBeginTime=x(p.value[0]).format("YYYY-MM-DD HH:mm:ss"),a.value.registerEndTime=x(p.value[1]).format("YYYY-MM-DD HH:mm:ss")},b=()=>{a.value.beginTime=x(i.value[0]).format("YYYY-MM-DD HH:mm:ss"),a.value.endTime=x(i.value[1]).format("YYYY-MM-DD HH:mm:ss")},f=(r,o,v)=>p.value?v():v(new Error("请选择比赛报名时间")),s=(r,o,v)=>{if(!i.value)return v(new Error("请选择比赛开始时间"));if(i.value)return v()},d=()=>{var r;(r=n.value)==null||r.validate((o,v)=>{o?_("changeStep",1):O({message:"请将参数填写完整",type:"warning"})})},u=Ce({title:[{required:!0,message:"请输入比赛名称",trigger:"blur"}],registerTime:[{required:!0,message:"请选择比赛报名时间",validator:f,trigger:"blur"}],contestTime:[{required:!0,message:"请选择比赛开始时间",validator:s,trigger:"blur"}],privatized:[{required:!0,message:"请选择是否公开比赛",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],contestMode:[{required:!0,message:"请选择比赛类型",trigger:"blur"}],description:[{required:!0,message:"请输入比赛描述",trigger:"blur"}]});return X(async()=>{var o;const r=await De({cid:k.cid});a.value=r.data,(o=a.value)==null||o.problemSet.forEach(v=>v.originalTitle=v.title),p.value=[x(r.data.registerBeginTime).toDate(),x(r.data.registerEndTime)],i.value=[x(r.data.beginTime).toDate(),x(r.data.endTime).toDate()]}),(r,o)=>{const v=te,B=ne,P=re,F=he,Y=ie,T=de,W=ee,K=se;return l(a)?(y(),R(K,{key:0,ref_key:"contestSettingFormRef",ref:n,class:"contest-setting-page-box",rules:u,model:l(a),"require-asterisk-position":"right","validate-on-rule-change":!0},{default:t(()=>[e(P,{label:"比赛名称","inline-message":"",prop:"title"},{default:t(()=>[e(B,{span:8},{default:t(()=>[e(v,{placeholder:"输入比赛名称",modelValue:l(a).title,"onUpdate:modelValue":o[0]||(o[0]=m=>l(a).title=m)},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{label:"报名时间",prop:"registerTime",required:""},{default:t(()=>[e(B,{span:12},{default:t(()=>[e(F,{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=m=>p.value=m),type:"datetimerange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date",onChange:c},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{label:"比赛时间",prop:"contestTime",required:""},{default:t(()=>[e(B,{span:12},{default:t(()=>[e(F,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=m=>i.value=m),type:"datetimerange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date",onChange:b},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{label:"比赛权限",prop:"privatized"},{default:t(()=>[e(T,{modelValue:l(a).privatized,"onUpdate:modelValue":o[3]||(o[3]=m=>l(a).privatized=m)},{default:t(()=>[e(Y,{value:0},{default:t(()=>[C("公开比赛")]),_:1}),e(Y,{value:1},{default:t(()=>[C("私有比赛")]),_:1})]),_:1},8,["modelValue"]),D(e(v,{placeholder:"私有密码",modelValue:l(a).privatePwd,"onUpdate:modelValue":o[4]||(o[4]=m=>l(a).privatePwd=m)},null,8,["modelValue"]),[[$,l(a).privatized]])]),_:1}),e(P,{label:"比赛赛制",prop:"contestMode"},{default:t(()=>[e(T,{modelValue:l(a).contestMode,"onUpdate:modelValue":o[5]||(o[5]=m=>l(a).contestMode=m)},{default:t(()=>[(y(),M(G,null,j([{label:"ACM",value:0},{label:"OI",value:1},{label:"IOI",value:2}],(m,Q)=>e(Y,{key:Q,label:m.value,value:m.value},{default:t(()=>[C(z(m.label),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"比赛说明",prop:"description"},{default:t(()=>[e(xe,{content:l(a).description,"onUpdate:content":o[6]||(o[6]=m=>l(a).description=m)},null,8,["content"])]),_:1}),e(P,null,{default:t(()=>[V("div",Re,[e(W,{type:"primary",onClick:d,size:"large"},{default:t(()=>[C("下一步")]),_:1})])]),_:1})]),_:1},8,["rules","model"])):Z("",!0)}}}),Ae={class:"problem-list-box"},Le={style:{cursor:"pointer",width:"20px",height:"20px",color:"#73767a","font-size":"18px"}},Fe={style:{display:"flex","align-items":"center","justify-content":"center","margin-top":"30px"}},Ne=H({__name:"SelectProblemSetPage",emits:["changeStep","handleSelected"],setup(w,{emit:h}){const k=L(),{editContestParams:n}=A(k),_=I({page:1,pageSize:10}),g=h,a=I(),S=async()=>{a.value=await Ue(_.value)},p=()=>{g("changeStep",-1)},i=()=>{g("changeStep",1)};Ee(()=>{var s;return(s=n.value)==null?void 0:s.problemSet.length},(s,d)=>{var u;(u=n.value)==null||u.problemSet.forEach((r,o)=>r.label=String.fromCharCode(65+o))});const c=we(()=>{var s;return(s=n.value)==null?void 0:s.problemSet.map(d=>d.pid)}),b=s=>{var d,u;(d=n.value)==null||d.problemSet.push({label:null,originalTitle:s.title,title:s.title,pid:s.id}),(u=c.value)==null||u.push(s.id)},f=s=>{var d;n.value.problemSet=(d=n.value)==null?void 0:d.problemSet.filter(u=>u.pid!==s.id)};return X(async()=>{await S()}),(s,d)=>{const u=te,r=ee,o=ne,v=re,B=ie,P=de,F=se,Y=me,T=Me,W=ze,K=Ye,m=Ie,Q=oe;return l(n)?(y(),R(Q,{key:0,class:"select-problem-list-page-box"},{header:t(()=>[e(F,{class:"problem-list-header"},{default:t(()=>[e(v,{label:"关键词"},{default:t(()=>[e(o,{span:6,style:{display:"flex"}},{default:t(()=>[e(u,{placeholder:"输入关键词",style:{"margin-right":"15px"}}),e(r,{type:"primary"},{default:t(()=>[C("搜索")]),_:1})]),_:1})]),_:1}),e(v,{label:"平台"},{default:t(()=>[e(P,null,{default:t(()=>[(y(!0),M(G,null,j([{label:"ALL",value:void 0},{label:"HDU",value:0},{label:"POJ",value:1},{label:"CF",value:2}],(U,N)=>(y(),R(B,{key:N,label:U.value,value:U.value},{default:t(()=>[C(z(U.label),1)]),_:2},1032,["label","value"]))),128))]),_:1})]),_:1})]),_:1})]),default:t(()=>{var U,N;return[V("div",Ae,[e(K,{data:(U=a.value)==null?void 0:U.records},{default:t(()=>[e(T,{width:"30px"},{default:t(E=>{var q,le;return[V("div",Le,[D(e(Y,{onClick:ue=>b(E.row)},{default:t(()=>[e(l(pe))]),_:2},1032,["onClick"]),[[$,!((q=c.value)!=null&&q.includes(E.row.id))]]),D(e(Y,{onClick:ue=>f(E.row)},{default:t(()=>[e(l(ce))]),_:2},1032,["onClick"]),[[$,(le=c.value)==null?void 0:le.includes(E.row.id)]])])]}),_:1}),e(T,{prop:"display_id",label:"题目ID",width:"120"}),e(T,{prop:"title",label:"标题"}),e(T,{label:"标签"},{default:t(E=>[(y(!0),M(G,null,j(E.row.tbTagList,q=>(y(),R(W,{key:q.id,"disable-transitions":!0},{default:t(()=>[C(z(q.tagName),1)]),_:2},1024))),128))]),_:1}),e(T,{prop:"difficulty",label:"Difficulty",width:"100",align:"center"})]),_:1},8,["data"]),e(m,{background:"",layout:"prev, pager, next","current-page":_.value.page,"onUpdate:currentPage":d[0]||(d[0]=E=>_.value.page=E),"page-size":_.value.pageSize,"onUpdate:pageSize":d[1]||(d[1]=E=>_.value.pageSize=E),onCurrentChange:S,total:(N=a.value)==null?void 0:N.total,style:{float:"right",padding:"10px"}},null,8,["current-page","page-size","total"])]),V("div",Fe,[e(r,{type:"primary",onClick:p},{default:t(()=>[C("上一步")]),_:1}),e(r,{type:"primary",onClick:i},{default:t(()=>[C("下一步")]),_:1})])]}),_:1})):Z("",!0)}}}),Oe=J(Ne,[["__scopeId","data-v-20adf1e6"]]),je={key:0,class:"arrange-problem-order-box"},Ge={style:{width:"30px"}},Je={style:{display:"flex","align-items":"center","justify-content":"center","margin-top":"30px"}},We=H({__name:"ArrangeOrderPage",emits:["changeStep"],setup(w,{emit:h}){const k=L(),{editContestParams:n,editResult:_}=A(k),g=h,a=(c,b)=>{const f=n.value.problemSet[c];n.value.problemSet[c]=n.value.problemSet[b],n.value.problemSet[b]=f,O({message:"交换成功",type:"success"})},S=c=>{Be.confirm("确定要删除吗?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n.value.problemSet.splice(c,1),O({type:"success",message:"Delete completed"})}).catch(()=>{O({type:"info",message:"Delete canceled"})})},p=()=>{g("changeStep",-1)},i=async()=>{_.value=await $e(n.value),g("changeStep",1)};return ke(()=>{var c;(c=n.value)==null||c.problemSet.forEach((b,f)=>b.label=String.fromCharCode(65+f))}),(c,b)=>{const f=te,s=ee;return l(n)?(y(),M("div",je,[(y(!0),M(G,null,j(l(n).problemSet,(d,u)=>(y(),M("div",{class:"item",key:u},[V("span",Ge,z(d.label),1),e(f,{modelValue:d.originalTitle,"onUpdate:modelValue":r=>d.originalTitle=r,style:{width:"25vw",height:"3vw"},disabled:""},null,8,["modelValue","onUpdate:modelValue"]),e(f,{modelValue:d.title,"onUpdate:modelValue":r=>d.title=r,style:{width:"25vw",height:"3vw"}},null,8,["modelValue","onUpdate:modelValue"]),e(s,{type:"danger",icon:l(_e),circle:"",onClick:r=>S(u)},null,8,["icon","onClick"]),e(s,{icon:l(ge),circle:"",disabled:u==0,onClick:r=>a(u,u-1)},null,8,["icon","disabled","onClick"]),e(s,{icon:l(fe),circle:"",disabled:u==l(n).problemSet.length-1,onClick:r=>a(u,u+1)},null,8,["icon","disabled","onClick"])]))),128)),V("div",Je,[e(s,{type:"primary",onClick:p},{default:t(()=>[C("上一步")]),_:1}),e(s,{type:"primary",onClick:i},{default:t(()=>[C("完成修改")]),_:1})])])):Z("",!0)}}}),Ke=J(We,[["__scopeId","data-v-fd8e521d"]]),Qe=w=>(Pe("data-v-8773bd88"),w=w(),Ve(),w),Xe={class:"complete-create-box"},Ze={class:"message-box"},et=Qe(()=>V("p",null,"快邀请你的小伙伴来参加吧！",-1)),tt=H({__name:"CreatedPage",emits:["changeStep"],setup(w,{emit:h}){const k=L(),{editContestParams:n,editResult:_}=A(k),g=I("");return X(async()=>{g.value=window.location.host}),(a,S)=>{var i,c,b;const p=qe;return y(),M("div",Xe,[V("div",Ze,z((i=l(_))==null?void 0:i.msg),1),D(V("div",null,[et,e(p,{href:"http://".concat(g.value,"/contest/").concat((c=l(_))==null?void 0:c.data)},{default:t(()=>{var f;return[C(z("http://".concat(g.value,"/contest/").concat((f=l(_))==null?void 0:f.data)),1)]}),_:1},8,["href"])],512),[[$,(b=l(_))==null?void 0:b.data]])])}}}),lt=J(tt,[["__scopeId","data-v-8773bd88"]]),at=H({__name:"ContestEditPage",props:{cid:{}},setup(w){const h=I(0),k=L(),{editContestParams:n,editResult:_}=A(k),g=S=>{h.value+=S},a=S=>{n.value.problemSet=S.map((p,i)=>({label:String.fromCharCode(65+i),originalTitle:p.title,title:p.title,pid:p.id}))};return(S,p)=>{const i=Se,c=ye,b=oe;return y(),R(b,{class:"contest-create-page-box"},{default:t(()=>[e(c,{space:200,active:h.value,simple:"",class:"steps-box"},{default:t(()=>[e(i,{title:"比赛设置",icon:l(ve)},null,8,["icon"]),e(i,{title:"选择题目",icon:l(be)},null,8,["icon"]),e(i,{title:"排列题目",icon:l(ae)},null,8,["icon"]),e(i,{title:"更新完成",icon:l(ae)},null,8,["icon"])]),_:1},8,["active"]),D(e(He,{cid:S.cid,onChangeStep:g},null,8,["cid"]),[[$,h.value==0]]),D(e(Oe,{onChangeStep:g,onHandleSelected:a},null,512),[[$,h.value==1]]),D(e(Ke,{onChangeStep:g},null,512),[[$,h.value==2]]),D(e(lt,{onChangeStep:g,result:l(_),"onUpdate:result":p[0]||(p[0]=f=>Te(_)?_.value=f:null)},null,8,["result"]),[[$,h.value==3]])]),_:1})}}}),Jt=J(at,[["__scopeId","data-v-c2db1b5f"]]);export{Jt as default};
