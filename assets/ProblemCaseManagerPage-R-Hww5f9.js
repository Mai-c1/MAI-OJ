import{L as pe,f as q,g as y,v as J,j as N,E as O,M as ke,N as $e,F as Ce,G as we,O as Pe,d as Re,_ as z,P as Le,x as Se,u as Fe}from"./base-Ka2KZoYH.js";import{E as Ue}from"./el-card-Oo7BEc2D.js";import{E as Te}from"./el-dialog-BQC55F59.js";import"./el-overlay-DUbqhrMD.js";import{E as Oe}from"./el-progress-uaxwC5I6.js";import{E as De,a as Be}from"./el-table-column--M48GZHB.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-BZ65vV3U.js";import"./el-scrollbar-KMsVKTcq.js";/* empty css               */import{E as je}from"./el-button-wNzNAogA.js";import{c as Ie,f as Me}from"./problem-CGZC5dUj.js";import{H as fe,a3 as C,d as T,i as D,A as Y,o as _,e as F,w as v,c as S,F as Ne,h as qe,n as b,l as a,S as me,P as L,f as k,g as U,N as I,a as g,t as Q,M as Ae,a4 as ze,J as He,D as Z,a5 as te,W as Ke,z as se,Y as Ve,L as Ge,V as Xe,a6 as ae,Q as oe,j as We,u as Je,q as A,p as Ye,m as Qe}from"./index-CS6SEU-6.js";/* empty css                   */import{E as ne}from"./index-CDmpcwB0.js";import{t as ee,d as Ze}from"./index-BIKjgQSY.js";import{a as xe,e as et}from"./use-global-config-AkHI4voN.js";import{b as H}from"./use-form-item-TS4f4MsT.js";import{b as tt}from"./_baseClone-HA74Ndxl.js";import{i as st}from"./isEqual-ZSzoOShP.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./focus-trap-CYXZ00VD.js";import"./refs-CichZi40.js";import"./event-BB_Ol6Sd.js";import"./constants-D8tHeVOq.js";import"./scroll-BIrBud54.js";import"./vnode-DHCEBWgO.js";import"./_initCloneObject-DTRei0L9.js";import"./index-riLredlm.js";import"./httpAdmin-CJWFygbr.js";var ot=1,nt=4;function le(s){return tt(s,ot|nt)}const ve=Symbol("uploadContextKey"),lt="ElUpload";class rt extends Error{constructor(l,e,f,d){super(l),this.name="UploadAjaxError",this.status=e,this.method=f,this.url=d}}function re(s,l,e){let f;return e.response?f="".concat(e.response.error||e.response):e.responseText?f="".concat(e.responseText):f="fail to ".concat(l.method," ").concat(s," ").concat(e.status),new rt(f,e.status,l.method,s)}function it(s){const l=s.responseText||s.response;if(!l)return l;try{return JSON.parse(l)}catch(e){return l}}const ut=s=>{typeof XMLHttpRequest>"u"&&ee(lt,"XMLHttpRequest is undefined");const l=new XMLHttpRequest,e=s.action;l.upload&&l.upload.addEventListener("progress",i=>{const m=i;m.percent=i.total>0?i.loaded/i.total*100:0,s.onProgress(m)});const f=new FormData;if(s.data)for(const[i,m]of Object.entries(s.data))fe(m)&&m.length?f.append(i,...m):f.append(i,m);f.append(s.filename,s.file,s.file.name),l.addEventListener("error",()=>{s.onError(re(e,s,l))}),l.addEventListener("load",()=>{if(l.status<200||l.status>=300)return s.onError(re(e,s,l));s.onSuccess(it(l))}),l.open(s.method,e,!0),s.withCredentials&&"withCredentials"in l&&(l.withCredentials=!0);const d=s.headers||{};if(d instanceof Headers)d.forEach((i,m)=>l.setRequestHeader(m,i));else for(const[i,m]of Object.entries(d))pe(m)||l.setRequestHeader(i,String(m));return l.send(f),l},ye=["text","picture","picture-card"];let dt=1;const x=()=>Date.now()+dt++,ge=q({action:{type:String,default:"#"},headers:{type:y(Object)},method:{type:String,default:"post"},data:{type:y([Object,Function,Promise]),default:()=>J({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:y(Array),default:()=>J([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:ye,default:"text"},httpRequest:{type:y(Function),default:ut},disabled:Boolean,limit:Number}),ct=q({...ge,beforeUpload:{type:y(Function),default:C},beforeRemove:{type:y(Function)},onRemove:{type:y(Function),default:C},onChange:{type:y(Function),default:C},onPreview:{type:y(Function),default:C},onSuccess:{type:y(Function),default:C},onProgress:{type:y(Function),default:C},onError:{type:y(Function),default:C},onExceed:{type:y(Function),default:C},crossorigin:{type:y(String)}}),pt=q({files:{type:y(Array),default:()=>J([])},disabled:{type:Boolean,default:!1},handlePreview:{type:y(Function),default:C},listType:{type:String,values:ye,default:"text"},crossorigin:{type:y(String)}}),ft={remove:s=>!!s},mt=["onKeydown"],vt=["src","crossorigin"],yt=["onClick"],gt=["title"],ht=["onClick"],bt=["onClick"],_t=T({name:"ElUploadList"}),Et=T({..._t,props:pt,emits:ft,setup(s,{emit:l}){const e=s,{t:f}=xe(),d=N("upload"),i=N("icon"),m=N("list"),$=H(),h=D(!1),w=Y(()=>[d.b("list"),d.bm("list",e.listType),d.is("disabled",e.disabled)]),E=p=>{l("remove",p)};return(p,n)=>(_(),F(ze,{tag:"ul",class:b(a(w)),name:a(m).b()},{default:v(()=>[(_(!0),S(Ne,null,qe(p.files,t=>(_(),S("li",{key:t.uid||t.name,class:b([a(d).be("list","item"),a(d).is(t.status),{focusing:h.value}]),tabindex:"0",onKeydown:me(u=>!a($)&&E(t),["delete"]),onFocus:n[0]||(n[0]=u=>h.value=!0),onBlur:n[1]||(n[1]=u=>h.value=!1),onClick:n[2]||(n[2]=u=>h.value=!1)},[L(p.$slots,"default",{file:t},()=>[p.listType==="picture"||t.status!=="uploading"&&p.listType==="picture-card"?(_(),S("img",{key:0,class:b(a(d).be("list","item-thumbnail")),src:t.url,crossorigin:p.crossorigin,alt:""},null,10,vt)):k("v-if",!0),t.status==="uploading"||p.listType!=="picture-card"?(_(),S("div",{key:1,class:b(a(d).be("list","item-info"))},[U("a",{class:b(a(d).be("list","item-name")),onClick:I(u=>p.handlePreview(t),["prevent"])},[g(a(O),{class:b(a(i).m("document"))},{default:v(()=>[g(a(ke))]),_:1},8,["class"]),U("span",{class:b(a(d).be("list","item-file-name")),title:t.name},Q(t.name),11,gt)],10,yt),t.status==="uploading"?(_(),F(a(Oe),{key:0,type:p.listType==="picture-card"?"circle":"line","stroke-width":p.listType==="picture-card"?6:2,percentage:Number(t.percentage),style:Ae(p.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):k("v-if",!0)],2)):k("v-if",!0),U("label",{class:b(a(d).be("list","item-status-label"))},[p.listType==="text"?(_(),F(a(O),{key:0,class:b([a(i).m("upload-success"),a(i).m("circle-check")])},{default:v(()=>[g(a($e))]),_:1},8,["class"])):["picture-card","picture"].includes(p.listType)?(_(),F(a(O),{key:1,class:b([a(i).m("upload-success"),a(i).m("check")])},{default:v(()=>[g(a(Ce))]),_:1},8,["class"])):k("v-if",!0)],2),a($)?k("v-if",!0):(_(),F(a(O),{key:2,class:b(a(i).m("close")),onClick:u=>E(t)},{default:v(()=>[g(a(we))]),_:2},1032,["class","onClick"])),k(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),k(" This is a bug which needs to be fixed "),k(" TODO: Fix the incorrect navigation interaction "),a($)?k("v-if",!0):(_(),S("i",{key:3,class:b(a(i).m("close-tip"))},Q(a(f)("el.upload.deleteTip")),3)),p.listType==="picture-card"?(_(),S("span",{key:4,class:b(a(d).be("list","item-actions"))},[U("span",{class:b(a(d).be("list","item-preview")),onClick:u=>p.handlePreview(t)},[g(a(O),{class:b(a(i).m("zoom-in"))},{default:v(()=>[g(a(Pe))]),_:1},8,["class"])],10,ht),a($)?k("v-if",!0):(_(),S("span",{key:0,class:b(a(d).be("list","item-delete")),onClick:u=>E(t)},[g(a(O),{class:b(a(i).m("delete"))},{default:v(()=>[g(a(Re))]),_:1},8,["class"])],10,bt))],2)):k("v-if",!0)])],42,mt))),128)),L(p.$slots,"append")]),_:3},8,["class","name"]))}});var ie=z(Et,[["__file","upload-list.vue"]]);const kt=q({disabled:{type:Boolean,default:!1}}),$t={file:s=>fe(s)},Ct=["onDrop","onDragover"],he="ElUploadDrag",wt=T({name:he}),Pt=T({...wt,props:kt,emits:$t,setup(s,{emit:l}){He(ve)||ee(he,"usage: <el-upload><el-upload-dragger /></el-upload>");const f=N("upload"),d=D(!1),i=H(),m=h=>{if(i.value)return;d.value=!1,h.stopPropagation();const w=Array.from(h.dataTransfer.files);l("file",w)},$=()=>{i.value||(d.value=!0)};return(h,w)=>(_(),S("div",{class:b([a(f).b("dragger"),a(f).is("dragover",d.value)]),onDrop:I(m,["prevent"]),onDragover:I($,["prevent"]),onDragleave:w[0]||(w[0]=I(E=>d.value=!1,["prevent"]))},[L(h.$slots,"default")],42,Ct))}});var Rt=z(Pt,[["__file","upload-dragger.vue"]]);const Lt=q({...ge,beforeUpload:{type:y(Function),default:C},onRemove:{type:y(Function),default:C},onStart:{type:y(Function),default:C},onSuccess:{type:y(Function),default:C},onProgress:{type:y(Function),default:C},onError:{type:y(Function),default:C},onExceed:{type:y(Function),default:C}}),St=["onKeydown"],Ft=["name","multiple","accept"],Ut=T({name:"ElUploadContent",inheritAttrs:!1}),Tt=T({...Ut,props:Lt,setup(s,{expose:l}){const e=s,f=N("upload"),d=H(),i=Z({}),m=Z(),$=o=>{if(o.length===0)return;const{autoUpload:c,limit:r,fileList:R,multiple:P,onStart:B,onExceed:K}=e;if(r&&R.length+o.length>r){K(o,R);return}P||(o=o.slice(0,1));for(const V of o){const M=V;M.uid=x(),B(M),c&&h(M)}},h=async o=>{if(m.value.value="",!e.beforeUpload)return E(o);let c,r={};try{const P=e.data,B=e.beforeUpload(o);r=te(e.data)?le(e.data):e.data,c=await B,te(e.data)&&st(P,r)&&(r=le(e.data))}catch(P){c=!1}if(c===!1){e.onRemove(o);return}let R=o;c instanceof Blob&&(c instanceof File?R=c:R=new File([c],o.name,{type:o.type})),E(Object.assign(R,{uid:o.uid}),r)},w=async(o,c)=>Ke(o)?o(c):o,E=async(o,c)=>{const{headers:r,data:R,method:P,withCredentials:B,name:K,action:V,onProgress:M,onSuccess:be,onError:_e,httpRequest:Ee}=e;try{c=await w(c!=null?c:R,o)}catch(j){e.onRemove(o);return}const{uid:G}=o,X={headers:r||{},withCredentials:B,file:o,data:c,method:P,filename:K,action:V,onProgress:j=>{M(j,o)},onSuccess:j=>{be(j,o),delete i.value[G]},onError:j=>{_e(j,o),delete i.value[G]}},W=Ee(X);i.value[G]=W,W instanceof Promise&&W.then(X.onSuccess,X.onError)},p=o=>{const c=o.target.files;c&&$(Array.from(c))},n=()=>{d.value||(m.value.value="",m.value.click())},t=()=>{n()};return l({abort:o=>{et(i.value).filter(o?([r])=>String(o.uid)===r:()=>!0).forEach(([r,R])=>{R instanceof XMLHttpRequest&&R.abort(),delete i.value[r]})},upload:h}),(o,c)=>(_(),S("div",{class:b([a(f).b(),a(f).m(o.listType),a(f).is("drag",o.drag)]),tabindex:"0",onClick:n,onKeydown:me(I(t,["self"]),["enter","space"])},[o.drag?(_(),F(Rt,{key:0,disabled:a(d),onFile:$},{default:v(()=>[L(o.$slots,"default")]),_:3},8,["disabled"])):L(o.$slots,"default",{key:1}),U("input",{ref_key:"inputRef",ref:m,class:b(a(f).e("input")),name:o.name,multiple:o.multiple,accept:o.accept,type:"file",onChange:p,onClick:c[0]||(c[0]=I(()=>{},["stop"]))},null,42,Ft)],42,St))}});var ue=z(Tt,[["__file","upload-content.vue"]]);const de="ElUpload",ce=s=>{var l;(l=s.url)!=null&&l.startsWith("blob:")&&URL.revokeObjectURL(s.url)},Ot=(s,l)=>{const e=Le(s,"fileList",void 0,{passive:!0}),f=n=>e.value.find(t=>t.uid===n.uid);function d(n){var t;(t=l.value)==null||t.abort(n)}function i(n=["ready","uploading","success","fail"]){e.value=e.value.filter(t=>!n.includes(t.status))}const m=(n,t)=>{const u=f(t);u&&(console.error(n),u.status="fail",e.value.splice(e.value.indexOf(u),1),s.onError(n,u,e.value),s.onChange(u,e.value))},$=(n,t)=>{const u=f(t);u&&(s.onProgress(n,u,e.value),u.status="uploading",u.percentage=Math.round(n.percent))},h=(n,t)=>{const u=f(t);u&&(u.status="success",u.response=n,s.onSuccess(n,u,e.value),s.onChange(u,e.value))},w=n=>{pe(n.uid)&&(n.uid=x());const t={name:n.name,percentage:0,status:"ready",size:n.size,raw:n,uid:n.uid};if(s.listType==="picture-card"||s.listType==="picture")try{t.url=URL.createObjectURL(n)}catch(u){Ze(de,u.message),s.onError(u,t,e.value)}e.value=[...e.value,t],s.onChange(t,e.value)},E=async n=>{const t=n instanceof File?f(n):n;t||ee(de,"file to be removed not found");const u=o=>{d(o);const c=e.value;c.splice(c.indexOf(o),1),s.onRemove(o,c),ce(o)};s.beforeRemove?await s.beforeRemove(t,e.value)!==!1&&u(t):u(t)};function p(){e.value.filter(({status:n})=>n==="ready").forEach(({raw:n})=>{var t;return n&&((t=l.value)==null?void 0:t.upload(n))})}return se(()=>s.listType,n=>{n!=="picture-card"&&n!=="picture"||(e.value=e.value.map(t=>{const{raw:u,url:o}=t;if(!o&&u)try{t.url=URL.createObjectURL(u)}catch(c){s.onError(c,t,e.value)}return t}))}),se(e,n=>{for(const t of n)t.uid||(t.uid=x()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:e,abort:d,clearFiles:i,handleError:m,handleProgress:$,handleStart:w,handleSuccess:h,handleRemove:E,submit:p,revokeFileObjectURL:ce}},Dt=T({name:"ElUpload"}),Bt=T({...Dt,props:ct,setup(s,{expose:l}){const e=s,f=H(),d=Z(),{abort:i,submit:m,clearFiles:$,uploadFiles:h,handleStart:w,handleError:E,handleRemove:p,handleSuccess:n,handleProgress:t,revokeFileObjectURL:u}=Ot(e,d),o=Y(()=>e.listType==="picture-card"),c=Y(()=>({...e,fileList:h.value,onStart:w,onProgress:t,onSuccess:n,onError:E,onRemove:p}));return Ve(()=>{h.value.forEach(u)}),Ge(ve,{accept:Xe(e,"accept")}),l({abort:i,submit:m,clearFiles:$,handleStart:w,handleRemove:p}),(r,R)=>(_(),S("div",null,[a(o)&&r.showFileList?(_(),F(ie,{key:0,disabled:a(f),"list-type":r.listType,files:a(h),crossorigin:r.crossorigin,"handle-preview":r.onPreview,onRemove:a(p)},ae({append:v(()=>[g(ue,oe({ref_key:"uploadRef",ref:d},a(c)),{default:v(()=>[r.$slots.trigger?L(r.$slots,"trigger",{key:0}):k("v-if",!0),!r.$slots.trigger&&r.$slots.default?L(r.$slots,"default",{key:1}):k("v-if",!0)]),_:3},16)]),_:2},[r.$slots.file?{name:"default",fn:v(({file:P})=>[L(r.$slots,"file",{file:P})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):k("v-if",!0),!a(o)||a(o)&&!r.showFileList?(_(),F(ue,oe({key:1,ref_key:"uploadRef",ref:d},a(c)),{default:v(()=>[r.$slots.trigger?L(r.$slots,"trigger",{key:0}):k("v-if",!0),!r.$slots.trigger&&r.$slots.default?L(r.$slots,"default",{key:1}):k("v-if",!0)]),_:3},16)):k("v-if",!0),r.$slots.trigger?L(r.$slots,"default",{key:2}):k("v-if",!0),L(r.$slots,"tip"),!a(o)&&r.showFileList?(_(),F(ie,{key:3,disabled:a(f),"list-type":r.listType,files:a(h),crossorigin:r.crossorigin,"handle-preview":r.onPreview,onRemove:a(p)},ae({_:2},[r.$slots.file?{name:"default",fn:v(({file:P})=>[L(r.$slots,"file",{file:P})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):k("v-if",!0)]))}});var jt=z(Bt,[["__file","upload.vue"]]);const It=Se(jt),Mt=s=>(Ye("data-v-d9a2e6ce"),s=s(),Qe(),s),Nt={class:"card-header"},qt={style:{"font-size":"large"}},At=Mt(()=>U("div",{class:"el-upload__text"},[A(" Drop file here or "),U("em",null,"click to upload")],-1)),zt={style:{width:"100%",display:"flex","justify-content":"flex-end","margin-top":"10px"}},Ht=T({__name:"ProblemCaseManagerPage",setup(s){const l=D(null),e=D(!1),f=Je(),d=D(),i=D(),m=D(),$=async()=>{const E=await Ie(i.value);d.value=E.data},h=async E=>{const p=await Me(E.id);$(),ne({type:"success",message:p.msg})},w=async()=>{const E=await l.value.submit();$(),e.value=!1,ne({type:"success",message:E.msg})};return We(async()=>{i.value=f.query.pid,m.value=f.query.displayId,$()}),(E,p)=>{const n=je,t=De,u=Be,o=O,c=It,r=Te,R=Ue;return _(),F(R,{class:"problem-case-manager-page-box"},{header:v(()=>[U("div",Nt,[U("span",qt,Q(E.$route.meta.title),1),g(n,{type:"success",size:"large",color:"#626aef",onClick:p[0]||(p[0]=P=>e.value=!0)},{default:v(()=>[A("上传评测数据")]),_:1})])]),default:v(()=>[g(u,{data:d.value,style:{width:"100%"},"header-cell-style":{"text-align":"center",color:"#000","font-weight":"bold"},"show-overflow-tooltip":"","cell-style":{"text-align":"center"}},{default:v(()=>[g(t,{prop:"id",label:"ID",width:"50"}),g(t,{prop:"inputContent",label:"输入"}),g(t,{prop:"outputContent",label:"输出"}),g(t,{label:"操作",width:"180"},{default:v(P=>[g(n,{onClick:B=>h(P.row),type:"danger"},{default:v(()=>[A("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),g(r,{modelValue:e.value,"onUpdate:modelValue":p[1]||(p[1]=P=>e.value=P),title:"上传评测数据",width:"500"},{default:v(()=>[g(c,{ref_key:"uploadRef",ref:l,action:"/admin-api/problemManager/uploadCase?pid=".concat(i.value,"&displayId=").concat(m.value),method:"POST",drag:"","auto-upload":!1},{trigger:v(()=>[g(o,{class:"el-icon--upload"},{default:v(()=>[g(a(Fe))]),_:1}),At]),default:v(()=>[U("div",zt,[g(n,{onClick:w,color:"#526aef"},{default:v(()=>[A(" 确认上传 ")]),_:1})])]),_:1},8,["action"])]),_:1},8,["modelValue"])]),_:1})}}}),_s=at(Ht,[["__scopeId","data-v-d9a2e6ce"]]);export{_s as default};
